<div class="flex flex-col justify-between w-1/6">
    <div>
    </div>

    <div class="w-full mx-auto border-t px-5">
      <span class="text-gray-100">Gratuit</span>
      <div class="my-2">
        <mat-progress-bar
          mode="determinate"
          value="{{ calcUsedStorage() }}"
        ></mat-progress-bar>
        <mat-progress-bar
          *ngIf="stateProgress == 'indeterminate'"
          mode="indeterminate"
        ></mat-progress-bar>
        <mat-progress-bar
          *ngIf="stateProgress == 'query'"
          mode="query"
        ></mat-progress-bar>
        <mat-progress-bar
          *ngIf="stateProgress == 'determinate'"
          mode="determinate"
          value="{{ calcUsedStorage() }}"
        ></mat-progress-bar>
      </div>

      <span class="text-gray-100">
        {{ sizeTotal | bytesConverter: "MB" }} /
        {{ sizeLimit | bytesConverter: "MB" }} (
        {{ calcUsedStorage().toFixed(0) }} % )
      </span>
    </div>
</div>
<div class="flex flex-grow flex-col h-full bg-dark2">
  <input multiple (change)="uploadFile(upload)" hidden #upload type="file" />
  <p>
    <mat-toolbar class="bg-transparent text-gray-100">
      <span>Cloud drive</span>
      <span class="flex-auto"></span>
      <button (click)="createFolder()" mat-button>
        <mat-icon>create_new_folder</mat-icon>
        Nouveau dossier
      </button>
      <button (click)="upload.click()" mat-button>
        <mat-icon>file_upload</mat-icon>
        Téléversement de fichiers
      </button>
    </mat-toolbar>
  </p>

  <div class="text-gray-100 px-4">
    <mat-form-field appearance="standard">
      <mat-label class="text-gray-100">Search</mat-label>
      <input
        class="text-gray-100"
        matInput
        (keyup)="applyFilter($event)"
        placeholder="Search for a file name"
        #input
      />
    </mat-form-field>
  </div>

  <div class="overflow-y-auto flex-grow">
    <table
      mat-table
      matSort
      [dataSource]="dataSource"
      class="mat-elevation-z8 text-gray-100 w-full border-separate"
    >
      <ng-container matColumnDef="name">
        <th
          class="text-gray-100"
          mat-header-cell
          mat-sort-header
          *matHeaderCellDef
        >
          Nom
        </th>
        <td mat-cell *matCellDef="let file">{{ file.name }}</td>
      </ng-container>

      <ng-container matColumnDef="size">
        <th
          class="text-gray-100"
          mat-header-cell
          mat-sort-header
          *matHeaderCellDef
        >
          Taille
        </th>
        <td mat-cell *matCellDef="let file">
          {{ file.originalSize | bytesConverter: "MB" }}
        </td>
      </ng-container>

      <ng-container matColumnDef="type">
        <th
          class="text-gray-100"
          mat-header-cell
          mat-sort-header
          *matHeaderCellDef
        >
          Type
        </th>
        <td mat-cell *matCellDef="let file">
          {{ file.type | mimeName: file.name }}
        </td>
      </ng-container>

      <ng-container matColumnDef="createdOn">
        <th
          class="text-gray-100"
          mat-header-cell
          mat-sort-header
          *matHeaderCellDef
        >
          Date d'ajout
        </th>
        <td mat-cell *matCellDef="let file">
          {{ file.createdOn | date: "MM/dd/yy HH:mm" }}
        </td>
      </ng-container>

      <tr
        class="bg-dark2 text-gray-100"
        mat-header-row
        *matHeaderRowDef="displayedColumns; sticky: true"
      ></tr>
      <tr
        (click)="pickFile($event, file)"
        (dblclick)="download(file.pubId)"
        [ngClass]="{
          'cursor-pointer': true,
          'bg-dark2': !isItPicked(file.name),
          'text-gray-100': true,
          'bg-gray-800': isItPicked(file.name),
          'hover:bg-gray-700': !isItPicked(file.name)
        }"
        mat-row
        *matRowDef="let file; columns: displayedColumns"
      ></tr>
    </table>
  </div>

  <div
    *ngIf="pickedElements?.size != 0"
    class="bg-dark1 flex justify-between text-gray-100 p-3 transition-all"
  >
    <!-- <div class="border bg-dark1 flex justify-between text-gray-100 p-3"> -->
    <div class="my-auto">
      {{ pickedElements?.size ?? 0 }} of {{ files.length }} items selected
      <span>{{ pickedElementsTotalSize | bytesConverter: "MB" }}</span>
    </div>
    <div>
      <button (click)="downloadSelection()" mat-icon-button>
        <mat-icon>file_download</mat-icon>
      </button>
      <button (click)="deleteFiles()" mat-icon-button>
        <mat-icon>delete_outline</mat-icon>
      </button>
      <button (click)="shareFile()" mat-icon-button>
        <mat-icon>share</mat-icon>
      </button>
    </div>
  </div>
</div>